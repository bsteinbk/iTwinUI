// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@import '../style/index';
@import '../icon/index';
@import './variables';

@mixin iui-table {
  @include iui-reset;
  @include iui-font-family;
  display: flex;
  flex-direction: column;
  padding: 0;

  * {
    box-sizing: border-box;
  }

  .iui-header,
  .iui-row {
    display: flex;
    flex-grow: 1;
    width: 100%;
  }

  .iui-header {
    user-select: none;
    @include themed {
      background-color: t(iui-color-background-3);
    }

    .iui-filter {
      margin-left: $iui-xs;
      position: relative;

      > .iui-borderless {
        position: absolute;
        left: 0;
        transform: translateY(-50%);

        &:not(.iui-active) {
          visibility: hidden;
        }
      }
    }

    .iui-cell:not(.iui-tables-slot) {
      @include iui-focus;
      cursor: pointer;

      &:hover,
      &:focus,
      &:focus-within {
        @include themed {
          background-color: t(iui-color-background-4);
        }

        .iui-sort,
        .iui-borderless {
          visibility: visible;
        }
      }
    }

    .iui-sort {
      visibility: hidden;
      margin-left: auto;
      width: $iui-icons-default;
      height: $iui-icons-default;
      @include themed {
        fill: t(iui-icons-color-actionable);
      }
    }

    .iui-active-sort {
      @include themed {
        background-color: t(iui-color-background-4);
      }

      .iui-sort {
        visibility: visible;
        
        &,
        & > * {
          @include themed {
            fill: t(iui-icons-color-actionable);
          }
        }
      }
    }
  }

  .iui-body {
    width: 100%;
    @include themed {
      background-color: t(iui-color-background-1);
    }
    
    .iui-row {
      margin-top: -1px;
      border: solid 1px transparent;

      &:not(:last-child) {
        @include themed {
          border-bottom: solid 1px t(iui-color-background-4);
        }
      }
  
      > .iui-tables-slot > .iui-button {
        visibility: hidden;
      }
  
      &:hover:not(.iui-disabled) {
        &:not(.iui-active) {
          @include themed {
            background-color: rgba(
              t(iui-color-foreground-primary-rgb),
              t(iui-opacity-6)
            ) !important;
          }
        }
  
        > .iui-tables-slot > .iui-button {
          visibility: visible;
        }
      }
  
      > .iui-cell {
        position: relative;
        align-items: center;
        display: flex;
        flex-grow: 1;
        min-width: 145px;
        padding: $iui-table-density;
        overflow: hidden;
        list-style: none;
        flex-basis: 145px;
  
        > svg {
          width: $iui-icons-default;
          height: $iui-icons-default;
          margin-right: $iui-sm;
        }
  
        > .iui-status,
        > .iui-progress-indicator-radial {
          float: right;
          margin-left: auto;
        }
  
        > .iui-status {
          margin-right: $iui-xs;
        }
  
        > .iui-user-icon {
          margin-right: $iui-s;
        }
  
        &.iui-tables-slot {
          width: $iui-l * 2;
          padding: 0;
          flex-grow: 0;
          min-width: 0;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-basis: $iui-l * 2;
  
          > .iui-icon {
            @include themed {
              fill: t(iui-icons-color-actionable);
              color: t(iui-icons-color-actionable);
            }
            width: $iui-icons-default;
            height: $iui-icons-default;
            margin: 0;
          }
        }
  
        &.iui-tables-head {
          @include themed {
            background-color: t(iui-color-background-3);
          }
          user-select: none;
  
          .iui-icon {
            @include themed {
              fill: t(iui-icons-color-actionable);
            }
  
            &:hover {
              @include themed {
                fill: t(iui-icons-color-actionable-hover);
              }
            }
          }
  
          > .iui-filter {
            margin-left: $iui-sm;
            cursor: pointer;
  
            > .iui-icon {
              width: $iui-icons-default;
              height: $iui-icons-default;
            }
          }
  
          > .iui-sort {
            flex-grow: 1;
            justify-content: flex-end !important;
  
            > .iui-icon-wrapper {
              cursor: pointer;
  
              > .iui-icon {
                width: $iui-icons-default;
                height: $iui-icons-default;
              }
            }
          }
  
          > .iui-filter,
          > .iui-sort,
          > .iui-sort > .iui-icon-wrapper {
            height: $iui-icons-default;
            width: $iui-icons-default;
            display: flex;
            justify-content: center;
            align-items: center;
            visibility: hidden;
          }
  
          > .iui-filter.iui-active {
            visibility: visible;
    
            > .iui-icon {
              @include themed {
                fill: t(iui-icons-color-primary);
              }
            }
          }
  
          &:hover {
            @include themed {
              background-color: t(iui-color-background-4);
            }
  
            > .iui-filter,
            > .iui-sort,
            > .iui-sort > .iui-icon-wrapper {
              visibility: visible;
            }
          }
        }
      }
  
      // #region Selection
      &:not(.iui-selected) + .iui-selected {
        border-bottom-color: transparent;
      }

      &.iui-active {
        @include themed {
          border-color: t(iui-color-foreground-primary);
          border-bottom-color: transparent;
          background-color: rgba(t(iui-color-foreground-primary-rgb), t(iui-opacity-5));
        }

        + .iui-active {
          @include themed {
            border-top-color: transparent;
          }

          + :not(.iui-selected) {
            @include themed {
              border-top-color: t(iui-color-foreground-primary);
            }
          }
        }
      }
      // #endregion Selection
  
      &.iui-new {
        font-weight: $iui-font-weight-semibold;

        /* UNSURE ABOUT THIS
        .iui-positive {
          @include themed {
            fill: t(iui-color-foreground-positive);
          }
        }
        */
  
        
        > .iui-main-column::before {
          @include themed {
            color: t(iui-color-foreground-positive);
          }
          content: 'â€¢';
          position: absolute;
          left: 0;
          font-size: $iui-font-size-title;
        }   
      }
  
      &.iui-disabled {
        font-style: italic;
        cursor: not-allowed;
        @include themed {
          color: t(iui-text-color-muted);
        }
  
        &:hover > .iui-tables-slot > .iui-button {
          visibility: hidden;
        }
  
        img,
        svg:not(.iui-radial),
        .iui-user-icon {
          filter: $iui-icons-color-multicolor-disabled;
        }
      }
    }
  }

  .iui-cell {
    align-items: center;
    display: flex;
    flex-grow: 1;
    min-width: 145px;
    padding: $iui-table-density;
    overflow: hidden;
    list-style: none;
    flex-basis: 145px;

    &.iui-right-align {
      justify-content: flex-end;
    }

    > svg {
      width: $iui-icons-default;
      height: $iui-icons-default;
      //margin-right: $iui-sm;
    }

    > .iui-status,
    > .iui-progress-indicator-radial {
      float: right;
      margin-left: auto;
    }

    > .iui-status {
      margin-right: $iui-xs;
    }

    > .iui-user-icon {
      margin-right: $iui-s;
    }

    &.iui-tables-slot {
      width: $iui-l * 2;
      padding: 0;
      flex-grow: 0;
      min-width: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-basis: $iui-l * 2;

      > .iui-icon {
        @include themed {
          fill: t(iui-icons-color-actionable);
          color: t(iui-icons-color-actionable);
        }
        width: $iui-icons-default;
        height: $iui-icons-default;
        margin: 0;
      }
    }

    &.iui-tables-head {
      @include themed {
        background-color: t(iui-color-background-3);
      }
      user-select: none;

      .iui-icon {
        @include themed {
          fill: t(iui-icons-color-actionable);
        }

        &:hover {
          @include themed {
            fill: t(iui-icons-color-actionable-hover);
          }
        }
      }

      > .iui-filter {
        margin-left: $iui-sm;
        cursor: pointer;

        > .iui-icon {
          width: $iui-icons-default;
          height: $iui-icons-default;
        }
      }

      > .iui-sort {
        flex-grow: 1;
        justify-content: flex-end !important;

        > .iui-icon-wrapper {
          cursor: pointer;

          > .iui-icon {
            width: $iui-icons-default;
            height: $iui-icons-default;
          }
        }
      }

      > .iui-filter,
      > .iui-sort,
      > .iui-sort > .iui-icon-wrapper {
        height: $iui-icons-default;
        width: $iui-icons-default;
        display: flex;
        justify-content: center;
        align-items: center;
        visibility: hidden;
      }

      > .iui-filter.iui-active {
        visibility: visible;

        > .iui-icon {
          @include themed {
            fill: t(iui-icons-color-primary);
          }
        }
      }

      &:hover {
        @include themed {
          background-color: t(iui-color-background-4);
        }

        > .iui-filter,
        > .iui-sort,
        > .iui-sort > .iui-icon-wrapper {
          visibility: visible;
        }
      }
    }
  }

  &.iui-zebra-striping > .iui-body > .iui-row:nth-child(even):not(.iui-active) {
    @include themed {
      background: rgba(t(iui-color-foreground-body-rgb), 0.02);
    }
  }

  &.iui-fixed > .iui-body {
    max-height: 300px;
    overflow-x: hidden;
    overflow-y: scroll;
    overflow: overlay;
  }
  
  /* EVERYTHING BELOW HERE IS OLD */

  

  .iui-select .iui-select-button {
    background-color: transparent;
    border: none;
  }


  .iui-tables-message-container {
    @include themed {
      color: t(iui-text-color-muted);
      background-color: t(iui-color-background-2);
    }
    display: flex;
    justify-content: center;
    height: 100%;
    padding: $iui-xl;
  }
}
